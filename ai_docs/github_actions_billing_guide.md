# GitHub Actions Billing Guide for AI Development

*Generated by AI Setup Deployment Script v2.40.0 on 2026-01-12 22:11:00 UTC*

## Critical Budget Information

**GitHub Free Tier Limits:**
- **Private Repositories**: 2,000 minutes/month
- **Public Repositories**: Unlimited (free)
- **Overage Cost**: $0.008 per minute

**Monthly Budget Reality:**
- 2,000 minutes √∑ 30 days = ~66 minutes/day
- Assuming 20 workflows/day = 3.3 minutes/workflow maximum

## Cost Optimization Strategies

### 1. Minimize Workflow Runtime

**Target: <1 minute per workflow**

```yaml
# Optimized workflow example
name: Fast Validation
on: [push, pull_request]

jobs:
  validate:
    runs-on: ubuntu-latest
    timeout-minutes: 2  # Strict timeout
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 1  # Shallow clone
      
      - name: Quick validation
        run: |
          # Only essential checks
          ./scripts/fast-validate.sh
```

### 2. Conditional Execution

**Run only when necessary:**

```yaml
# Skip workflows for certain files
on:
  push:
    paths-ignore:
      - '**.md'
      - 'docs/**'
      - '.gitignore'
  
# Skip on certain commit messages
jobs:
  build:
    if: "!contains(github.event.head_commit.message, '[skip ci]')"
```

### 3. Workflow Consolidation

**Combine related checks:**

```yaml
# Instead of multiple workflows, use one with parallel jobs
jobs:
  all-checks:
    strategy:
      matrix:
        check: [lint, format, security]
    steps:
      - name: Run ${{ matrix.check }}
        run: npm run ${{ matrix.check }}
```

### 4. Caching Strategy

**Aggressive caching reduces runtime:**

```yaml
- uses: actions/cache@v3
  with:
    path: |
      ~/.npm
      ~/.cache
      node_modules
    key: ${{ runner.os }}-deps-${{ hashFiles('**/package-lock.json') }}
    restore-keys: |
      ${{ runner.os }}-deps-
```

## Budget Protection Patterns

### 1. Daily/Weekly Limits

```yaml
# Run expensive workflows weekly only
on:
  schedule:
    - cron: '0 2 * * 0'  # Sunday 2 AM only
  workflow_dispatch:  # Manual trigger
```

### 2. Progressive Validation

```yaml
# Quick checks first, expensive later
jobs:
  quick-check:
    runs-on: ubuntu-latest
    timeout-minutes: 1
    steps:
      - name: Fast validation
        run: ./quick-check.sh
  
  full-check:
    needs: quick-check
    if: github.event_name == 'pull_request'
    timeout-minutes: 5
    steps:
      - name: Comprehensive validation
        run: ./full-check.sh
```

### 3. Manual Gates

```yaml
# Require manual approval for expensive operations
jobs:
  approve:
    runs-on: ubuntu-latest
    steps:
      - uses: trstringer/manual-approval@v1
        with:
          approvers: team-leads
  
  expensive-job:
    needs: approve
    runs-on: ubuntu-latest
    steps:
      - name: Run expensive tests
        run: ./expensive-tests.sh
```

## Monitoring and Alerts

### 1. Usage Tracking

```bash
# GitHub CLI usage check
gh api /repos/{owner}/{repo}/actions/runs \
  --jq '[.workflow_runs[] | {name: .name, minutes: .run_duration_ms/60000}]'
```

### 2. Budget Alerts

```yaml
# Weekly usage report workflow
name: Usage Report
on:
  schedule:
    - cron: '0 9 * * 1'  # Monday 9 AM

jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - name: Calculate usage
        run: |
          # Get this month's usage
          USAGE=$(gh api /repos/${{ github.repository }}/actions/runs \
            --jq '[.workflow_runs[] | select(.created_at | startswith("2024-01")) | .run_duration_ms] | add / 60000')
          
          echo "Minutes used this month: $USAGE"
          
          if (( $(echo "$USAGE > 1500" | bc -l) )); then
            echo "‚ö†Ô∏è WARNING: Approaching monthly limit!"
          fi
```

## Emergency Measures

### When Approaching Limit

1. **Disable non-critical workflows:**
```bash
# Disable workflow
gh workflow disable "comprehensive-tests.yml"
```

2. **Switch to manual triggers only:**
```yaml
on:
  workflow_dispatch:  # Manual only
```

3. **Use local validation:**
```bash
# Run validation locally instead
./scripts/local-validation.sh
```

## Cost-Effective Patterns

### 1. Fail Fast

```yaml
strategy:
  fail-fast: true  # Stop all jobs if one fails
  matrix:
    node: [14, 16, 18]
```

### 2. Smart Test Selection

```yaml
- name: Determine tests to run
  run: |
    # Only run tests for changed files
    CHANGED=$(git diff --name-only HEAD~1)
    npm test -- --findRelatedTests $CHANGED
```

### 3. Tiered Validation

**Development branches**: Minimal checks (< 1 min)
**Pull requests**: Standard checks (< 2 min)  
**Main branch**: Full validation (weekly)
**Releases**: Comprehensive testing (manual)

## Alternative Solutions

### 1. Local Pre-commit Hooks
```bash
# .git/hooks/pre-push
#!/bin/bash
echo "Running local validation..."
npm run lint && npm test
```

### 2. Self-Hosted Runners
For high-volume projects, consider self-hosted runners:
- No minute limits
- Full control over environment
- Requires infrastructure maintenance

### 3. Other CI/CD Services
Compare with free tiers:
- GitLab CI: 400 minutes/month
- CircleCI: 6,000 minutes/month
- Travis CI: 10,000 credits/month

## Best Practices Summary

1. **Always set timeout-minutes** on jobs
2. **Cache aggressively** to reduce setup time
3. **Use path filters** to skip unnecessary runs
4. **Consolidate workflows** where possible
5. **Monitor usage weekly** to avoid surprises
6. **Have a plan B** for when limits are reached
7. **Document expensive workflows** for team awareness

## Monthly Budget Template

```markdown
## GitHub Actions Budget - [Month]

**Allocation:**
- Daily builds: 500 min (25%)
- PR validation: 800 min (40%)
- Weekly comprehensive: 400 min (20%)
- Emergency buffer: 300 min (15%)

**Usage Tracking:**
- Week 1: ___ min
- Week 2: ___ min
- Week 3: ___ min
- Week 4: ___ min

**Status**: üü¢ On Budget / üü° Caution / üî¥ Over Budget
```

---

*Remember: Every minute counts. Optimize ruthlessly and monitor constantly.*
